T = [ load('rmsSdcnCorr.dat') load('rmsBkbn.dat') load('lrmsd.dat') load('rmsWat.dat') ];
T = T(:,[ 2 4 5 7 ]);
T(:,4) = T(:,4).^2;
sc = size(T);
nave = 40;
nnode = floor(sc(1,1)/nave);
nT = zeros(nnode, 4);

for i = 1:1:nnode,
  nT(i,:) = mean(T(nave*(i-1)+1:nave*i,:));
end

save rmsSmooth.dat nT -ascii

W = zeros(sc(1,1), 144);
tmp = load('rmsWat721.dat');
W(:,721-720) = tmp(:,2);
tmp = load('rmsWat722.dat');
W(:,722-720) = tmp(:,2);
tmp = load('rmsWat723.dat');
W(:,723-720) = tmp(:,2);
tmp = load('rmsWat724.dat');
W(:,724-720) = tmp(:,2);
tmp = load('rmsWat725.dat');
W(:,725-720) = tmp(:,2);
tmp = load('rmsWat726.dat');
W(:,726-720) = tmp(:,2);
tmp = load('rmsWat727.dat');
W(:,727-720) = tmp(:,2);
tmp = load('rmsWat728.dat');
W(:,728-720) = tmp(:,2);
tmp = load('rmsWat729.dat');
W(:,729-720) = tmp(:,2);
tmp = load('rmsWat730.dat');
W(:,730-720) = tmp(:,2);
tmp = load('rmsWat731.dat');
W(:,731-720) = tmp(:,2);
tmp = load('rmsWat732.dat');
W(:,732-720) = tmp(:,2);
tmp = load('rmsWat733.dat');
W(:,733-720) = tmp(:,2);
tmp = load('rmsWat734.dat');
W(:,734-720) = tmp(:,2);
tmp = load('rmsWat735.dat');
W(:,735-720) = tmp(:,2);
tmp = load('rmsWat736.dat');
W(:,736-720) = tmp(:,2);
tmp = load('rmsWat737.dat');
W(:,737-720) = tmp(:,2);
tmp = load('rmsWat738.dat');
W(:,738-720) = tmp(:,2);
tmp = load('rmsWat739.dat');
W(:,739-720) = tmp(:,2);
tmp = load('rmsWat740.dat');
W(:,740-720) = tmp(:,2);
tmp = load('rmsWat741.dat');
W(:,741-720) = tmp(:,2);
tmp = load('rmsWat742.dat');
W(:,742-720) = tmp(:,2);
tmp = load('rmsWat743.dat');
W(:,743-720) = tmp(:,2);
tmp = load('rmsWat744.dat');
W(:,744-720) = tmp(:,2);
tmp = load('rmsWat745.dat');
W(:,745-720) = tmp(:,2);
tmp = load('rmsWat746.dat');
W(:,746-720) = tmp(:,2);
tmp = load('rmsWat747.dat');
W(:,747-720) = tmp(:,2);
tmp = load('rmsWat748.dat');
W(:,748-720) = tmp(:,2);
tmp = load('rmsWat749.dat');
W(:,749-720) = tmp(:,2);
tmp = load('rmsWat750.dat');
W(:,750-720) = tmp(:,2);
tmp = load('rmsWat751.dat');
W(:,751-720) = tmp(:,2);
tmp = load('rmsWat752.dat');
W(:,752-720) = tmp(:,2);
tmp = load('rmsWat753.dat');
W(:,753-720) = tmp(:,2);
tmp = load('rmsWat754.dat');
W(:,754-720) = tmp(:,2);
tmp = load('rmsWat755.dat');
W(:,755-720) = tmp(:,2);
tmp = load('rmsWat756.dat');
W(:,756-720) = tmp(:,2);
tmp = load('rmsWat757.dat');
W(:,757-720) = tmp(:,2);
tmp = load('rmsWat758.dat');
W(:,758-720) = tmp(:,2);
tmp = load('rmsWat759.dat');
W(:,759-720) = tmp(:,2);
tmp = load('rmsWat760.dat');
W(:,760-720) = tmp(:,2);
tmp = load('rmsWat761.dat');
W(:,761-720) = tmp(:,2);
tmp = load('rmsWat762.dat');
W(:,762-720) = tmp(:,2);
tmp = load('rmsWat763.dat');
W(:,763-720) = tmp(:,2);
tmp = load('rmsWat764.dat');
W(:,764-720) = tmp(:,2);
tmp = load('rmsWat765.dat');
W(:,765-720) = tmp(:,2);
tmp = load('rmsWat766.dat');
W(:,766-720) = tmp(:,2);
tmp = load('rmsWat767.dat');
W(:,767-720) = tmp(:,2);
tmp = load('rmsWat768.dat');
W(:,768-720) = tmp(:,2);
tmp = load('rmsWat769.dat');
W(:,769-720) = tmp(:,2);
tmp = load('rmsWat770.dat');
W(:,770-720) = tmp(:,2);
tmp = load('rmsWat771.dat');
W(:,771-720) = tmp(:,2);
tmp = load('rmsWat772.dat');
W(:,772-720) = tmp(:,2);
tmp = load('rmsWat773.dat');
W(:,773-720) = tmp(:,2);
tmp = load('rmsWat774.dat');
W(:,774-720) = tmp(:,2);
tmp = load('rmsWat775.dat');
W(:,775-720) = tmp(:,2);
tmp = load('rmsWat776.dat');
W(:,776-720) = tmp(:,2);
tmp = load('rmsWat777.dat');
W(:,777-720) = tmp(:,2);
tmp = load('rmsWat778.dat');
W(:,778-720) = tmp(:,2);
tmp = load('rmsWat779.dat');
W(:,779-720) = tmp(:,2);
tmp = load('rmsWat780.dat');
W(:,780-720) = tmp(:,2);
tmp = load('rmsWat781.dat');
W(:,781-720) = tmp(:,2);
tmp = load('rmsWat782.dat');
W(:,782-720) = tmp(:,2);
tmp = load('rmsWat783.dat');
W(:,783-720) = tmp(:,2);
tmp = load('rmsWat784.dat');
W(:,784-720) = tmp(:,2);
tmp = load('rmsWat785.dat');
W(:,785-720) = tmp(:,2);
tmp = load('rmsWat786.dat');
W(:,786-720) = tmp(:,2);
tmp = load('rmsWat787.dat');
W(:,787-720) = tmp(:,2);
tmp = load('rmsWat788.dat');
W(:,788-720) = tmp(:,2);
tmp = load('rmsWat789.dat');
W(:,789-720) = tmp(:,2);
tmp = load('rmsWat790.dat');
W(:,790-720) = tmp(:,2);
tmp = load('rmsWat791.dat');
W(:,791-720) = tmp(:,2);
tmp = load('rmsWat792.dat');
W(:,792-720) = tmp(:,2);
tmp = load('rmsWat793.dat');
W(:,793-720) = tmp(:,2);
tmp = load('rmsWat794.dat');
W(:,794-720) = tmp(:,2);
tmp = load('rmsWat795.dat');
W(:,795-720) = tmp(:,2);
tmp = load('rmsWat796.dat');
W(:,796-720) = tmp(:,2);
tmp = load('rmsWat797.dat');
W(:,797-720) = tmp(:,2);
tmp = load('rmsWat798.dat');
W(:,798-720) = tmp(:,2);
tmp = load('rmsWat799.dat');
W(:,799-720) = tmp(:,2);
tmp = load('rmsWat800.dat');
W(:,800-720) = tmp(:,2);
tmp = load('rmsWat801.dat');
W(:,801-720) = tmp(:,2);
tmp = load('rmsWat802.dat');
W(:,802-720) = tmp(:,2);
tmp = load('rmsWat803.dat');
W(:,803-720) = tmp(:,2);
tmp = load('rmsWat804.dat');
W(:,804-720) = tmp(:,2);
tmp = load('rmsWat805.dat');
W(:,805-720) = tmp(:,2);
tmp = load('rmsWat806.dat');
W(:,806-720) = tmp(:,2);
tmp = load('rmsWat807.dat');
W(:,807-720) = tmp(:,2);
tmp = load('rmsWat808.dat');
W(:,808-720) = tmp(:,2);
tmp = load('rmsWat809.dat');
W(:,809-720) = tmp(:,2);
tmp = load('rmsWat810.dat');
W(:,810-720) = tmp(:,2);
tmp = load('rmsWat811.dat');
W(:,811-720) = tmp(:,2);
tmp = load('rmsWat812.dat');
W(:,812-720) = tmp(:,2);
tmp = load('rmsWat813.dat');
W(:,813-720) = tmp(:,2);
tmp = load('rmsWat814.dat');
W(:,814-720) = tmp(:,2);
tmp = load('rmsWat815.dat');
W(:,815-720) = tmp(:,2);
tmp = load('rmsWat816.dat');
W(:,816-720) = tmp(:,2);
tmp = load('rmsWat817.dat');
W(:,817-720) = tmp(:,2);
tmp = load('rmsWat818.dat');
W(:,818-720) = tmp(:,2);
tmp = load('rmsWat819.dat');
W(:,819-720) = tmp(:,2);
tmp = load('rmsWat820.dat');
W(:,820-720) = tmp(:,2);
tmp = load('rmsWat821.dat');
W(:,821-720) = tmp(:,2);
tmp = load('rmsWat822.dat');
W(:,822-720) = tmp(:,2);
tmp = load('rmsWat823.dat');
W(:,823-720) = tmp(:,2);
tmp = load('rmsWat824.dat');
W(:,824-720) = tmp(:,2);
tmp = load('rmsWat825.dat');
W(:,825-720) = tmp(:,2);
tmp = load('rmsWat826.dat');
W(:,826-720) = tmp(:,2);
tmp = load('rmsWat827.dat');
W(:,827-720) = tmp(:,2);
tmp = load('rmsWat828.dat');
W(:,828-720) = tmp(:,2);
tmp = load('rmsWat829.dat');
W(:,829-720) = tmp(:,2);
tmp = load('rmsWat830.dat');
W(:,830-720) = tmp(:,2);
tmp = load('rmsWat831.dat');
W(:,831-720) = tmp(:,2);
tmp = load('rmsWat832.dat');
W(:,832-720) = tmp(:,2);
tmp = load('rmsWat833.dat');
W(:,833-720) = tmp(:,2);
tmp = load('rmsWat834.dat');
W(:,834-720) = tmp(:,2);
tmp = load('rmsWat835.dat');
W(:,835-720) = tmp(:,2);
tmp = load('rmsWat836.dat');
W(:,836-720) = tmp(:,2);
tmp = load('rmsWat837.dat');
W(:,837-720) = tmp(:,2);
tmp = load('rmsWat838.dat');
W(:,838-720) = tmp(:,2);
tmp = load('rmsWat839.dat');
W(:,839-720) = tmp(:,2);
tmp = load('rmsWat840.dat');
W(:,840-720) = tmp(:,2);
tmp = load('rmsWat841.dat');
W(:,841-720) = tmp(:,2);
tmp = load('rmsWat842.dat');
W(:,842-720) = tmp(:,2);
tmp = load('rmsWat843.dat');
W(:,843-720) = tmp(:,2);
tmp = load('rmsWat844.dat');
W(:,844-720) = tmp(:,2);
tmp = load('rmsWat845.dat');
W(:,845-720) = tmp(:,2);
tmp = load('rmsWat846.dat');
W(:,846-720) = tmp(:,2);
tmp = load('rmsWat847.dat');
W(:,847-720) = tmp(:,2);
tmp = load('rmsWat848.dat');
W(:,848-720) = tmp(:,2);
tmp = load('rmsWat849.dat');
W(:,849-720) = tmp(:,2);
tmp = load('rmsWat850.dat');
W(:,850-720) = tmp(:,2);
tmp = load('rmsWat851.dat');
W(:,851-720) = tmp(:,2);
tmp = load('rmsWat852.dat');
W(:,852-720) = tmp(:,2);
tmp = load('rmsWat853.dat');
W(:,853-720) = tmp(:,2);
tmp = load('rmsWat854.dat');
W(:,854-720) = tmp(:,2);
tmp = load('rmsWat855.dat');
W(:,855-720) = tmp(:,2);
tmp = load('rmsWat856.dat');
W(:,856-720) = tmp(:,2);
tmp = load('rmsWat857.dat');
W(:,857-720) = tmp(:,2);
tmp = load('rmsWat858.dat');
W(:,858-720) = tmp(:,2);
tmp = load('rmsWat859.dat');
W(:,859-720) = tmp(:,2);
tmp = load('rmsWat860.dat');
W(:,860-720) = tmp(:,2);
tmp = load('rmsWat861.dat');
W(:,861-720) = tmp(:,2);
tmp = load('rmsWat862.dat');
W(:,862-720) = tmp(:,2);
tmp = load('rmsWat863.dat');
W(:,863-720) = tmp(:,2);
tmp = load('rmsWat864.dat');
W(:,864-720) = tmp(:,2);
sc = size(T);
nave = 40;
nnode = floor(sc(1,1)/nave);
nW = zeros(nnode, 144);

for i = 1:1:nnode,
  nW(i,:) = mean(W(nave*(i-1)+1:nave*i,:));
end

save watSmooth.dat nW -ascii

